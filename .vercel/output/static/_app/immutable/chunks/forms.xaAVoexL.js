import{p as E,i as w,c as L}from"./entry.DNyy5_P4.js";function g(e){const r=JSON.parse(e);return r.data&&(r.data=E(r.data)),r}function y(e){return HTMLElement.prototype.cloneNode.call(e)}function k(e,r=()=>{}){const l=async({action:a,result:c,reset:i=!0,invalidateAll:n=!0})=>{c.type==="success"&&(i&&HTMLFormElement.prototype.reset.call(e),n&&await w()),(location.origin+location.pathname===a.origin+a.pathname||c.type==="redirect"||c.type==="error")&&L(c)};async function s(a){var p,b,f,h;if(((p=a.submitter)!=null&&p.hasAttribute("formmethod")?a.submitter.formMethod:y(e).method)!=="post")return;a.preventDefault();const i=new URL((b=a.submitter)!=null&&b.hasAttribute("formaction")?a.submitter.formAction:y(e).action),n=new FormData(e),u=(f=a.submitter)==null?void 0:f.getAttribute("name");u&&n.append(u,((h=a.submitter)==null?void 0:h.getAttribute("value"))??"");const m=new AbortController;let d=!1;const A=await r({action:i,cancel:()=>d=!0,controller:m,formData:n,formElement:e,submitter:a.submitter})??l;if(d)return;let o;try{const t=await fetch(i,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:n,signal:m.signal});o=g(await t.text()),o.type==="error"&&(o.status=t.status)}catch(t){if((t==null?void 0:t.name)==="AbortError")return;o={type:"error",error:t}}A({action:i,formData:n,formElement:e,update:t=>l({action:i,result:o,reset:t==null?void 0:t.reset,invalidateAll:t==null?void 0:t.invalidateAll}),result:o})}return HTMLFormElement.prototype.addEventListener.call(e,"submit",s),{destroy(){HTMLFormElement.prototype.removeEventListener.call(e,"submit",s)}}}export{k as e};
